
https://leetcode.com/problems/number-of-comments-per-post/

WITH A1 AS(
SELECT DISTINCT SUB_ID
FROM SUBMISSIONS
WHERE PARENT_ID IS NULL
),

B1 AS (
SELECT DISTINCT SUB_ID,PARENT_ID
FROM SUBMISSIONS
WHERE PARENT_ID IS NOT NULL
    )
    
    SELECT A.SUB_ID AS POST_ID, SUM(CASE WHEN B.PARENT_ID IS NOT NULL THEN 1 ELSE 0 END) AS  number_of_comments 
    FROM A1 A LEFT JOIN B1 B ON (A.SUB_ID = B.PARENT_ID)
    GROUP BY A.SUB_ID
    ORDER BY A.SUB_ID