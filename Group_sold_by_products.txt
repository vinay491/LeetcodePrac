/*  https://leetcode.com/problems/group-sold-products-by-the-date/   */

SELECT SUBSTR(SELL_DATE,1,10)  AS SELL_DATE, COUNT(DISTINCT(PRODUCT)) AS NUM_SOLD,
LISTAGG(PRODUCT,',') WITHIN GROUP (ORDER BY PRODUCT) AS PRODUCTS
FROM 
(SELECT DISTINCT SELL_DATE, PRODUCT FROM ACTIVITIES)
GROUP BY SELL_DATE